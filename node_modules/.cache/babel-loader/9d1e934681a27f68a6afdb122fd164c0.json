{"ast":null,"code":"import \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/input/style\";\nimport _Input from \"antd/es/input\";\nimport \"antd/es/message/style\";\nimport _message from \"antd/es/message\";\nimport \"antd/es/form/style\";\nimport _Form from \"antd/es/form\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\PC\\\\Desktop\\\\react-project\\\\src\\\\containers\\\\Login\\\\index.jsx\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { createSaveUserInfoAction } from '../../redux/actions_creators/login_action';\nimport './css/login.less';\nimport { reqLogin } from '../../api';\nimport { UserOutlined, LockOutlined } from '@ant-design/icons';\nimport logo from './img/dora_17.png';\nimport { Redirect } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  Item\n} = _Form;\n\nconst Login = props => {\n  _s();\n\n  const [form] = _Form.useForm(); // 如果用户已经登录 自动跳转到管理界面\n\n  /* const user = props.user\r\n  if (user._id) {\r\n    return <Redirect to='/home'/>\r\n  } */\n  // 点击登录按钮的回调\n\n\n  const onFinish = async values => {\n    // console.log('Received values of form: ', values);\n    // 请求登录\n    const {\n      username,\n      password\n    } = values;\n    /* reqLogin(username,password).then(response => {\r\n      console.log('成功了',response.data);\r\n    }).catch(error => {\r\n      console.log('失败了',error.message);\r\n    }) */\n    //#region \n    // 优化1\n\n    const result = await reqLogin(username, password);\n    let {\n      data,\n      status,\n      msg\n    } = result; // {status:0, data:user}  {status:1,msg:'xxx'}\n\n    if (status === 0) {\n      //登录成功\n      // 提示登录成功\n      // console.log('请求成功了',data);\n      _message.success('登录成功'); // 跳转到admin界面（不需要再回退回到登录）\n\n\n      props.saveUserInfo(data);\n      props.history.replace('/Admin');\n    } else {\n      //登录失败\n      _message.warning(msg, 1); //提示错误信息\n\n    }\n  };\n\n  const NameValidator = value => {\n    if (value) {\n      if (value.length >= 4 && value.length <= 30) {\n        return Promise.resolve();\n      } else {\n        return Promise.resolve();\n        /* reject('名称长度为4-30个字符，一个中文字等于2个字符') */\n      }\n    } else {\n      return Promise.resolve();\n    }\n  };\n\n  const tailLayout = {\n    wrapperCol: {\n      offset: 10,\n      span: 16\n    }\n  };\n  const {\n    isLogin\n  } = props;\n\n  if (isLogin) {\n    return /*#__PURE__*/_jsxDEV(Redirect, {\n      to: \"/Admin/Home\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 12\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"login\",\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"login-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: logo,\n        alt: \"logo\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: [\"\\u540E\\u53F0\\u7BA1\\u7406\\u7CFB\\u7EDF\", props.test]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"login-content\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"\\u7528\\u6237\\u767B\\u9646\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(_Form, {\n        form: form,\n        name: \"normal_login\",\n        className: \"login-form\",\n        initialValues: {\n          remember: true,\n          username: '云显靖'\n        },\n        onFinish: onFinish // onSubmit={handleSubmit}\n        ,\n        children: [/*#__PURE__*/_jsxDEV(Item, {\n          name: \"username\" // 声明式验证：直接使用别人定义好的验证规则进行验证\n          ,\n          rules: [{\n            required: true,\n            whitespace: true,\n            message: '请输入用户名!'\n          }, {\n            min: 4,\n            message: '用户名最少4位'\n          }, {\n            max: 12,\n            message: '用户名最多12位'\n          }, {\n            pattern: /^[a-zA-Z0-9_]+$/,\n            message: '用户名必须是英文 数字或者下划线组成'\n          }],\n          children: /*#__PURE__*/_jsxDEV(_Input, {\n            prefix: /*#__PURE__*/_jsxDEV(UserOutlined, {\n              className: \"site-form-item-icon\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 30\n            }, this),\n            placeholder: \"\\u7528\\u6237\\u540D\",\n            style: {\n              color: 'rgba(0,0,0,.25)'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Item, {\n          name: \"password\",\n          rules: [{\n            required: true,\n            message: 'Please input your Password!'\n          }, {\n            validator: NameValidator\n          }],\n          children: /*#__PURE__*/_jsxDEV(_Input, {\n            prefix: /*#__PURE__*/_jsxDEV(LockOutlined, {\n              className: \"site-form-item-icon\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 111,\n              columnNumber: 30\n            }, this),\n            type: \"password\",\n            placeholder: \"\\u5BC6\\u7801\",\n            style: {\n              color: 'rgba(0,0,0,.25)'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Item, { ...tailLayout,\n          children: /*#__PURE__*/_jsxDEV(_Button, {\n            type: \"primary\",\n            htmlType: \"submit\",\n            className: \"login-form-button\",\n            children: \"\\u767B\\u5F55\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 7\n  }, this);\n}; // 暴露容器\n\n\n_s(Login, \"rI7DrJIrFu7YmlGWYiMFTzs8jF0=\", false, function () {\n  return [_Form.useForm];\n});\n\n_c = Login;\nexport default connect(state => ({\n  isLogin: state.userInfo.isLogin\n}), {\n  saveUserInfo: createSaveUserInfoAction\n})(Login);\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["C:/Users/PC/Desktop/react-project/src/containers/Login/index.jsx"],"names":["React","connect","createSaveUserInfoAction","reqLogin","UserOutlined","LockOutlined","logo","Redirect","Item","Login","props","form","useForm","onFinish","values","username","password","result","data","status","msg","success","saveUserInfo","history","replace","warning","NameValidator","value","length","Promise","resolve","tailLayout","wrapperCol","offset","span","isLogin","test","remember","required","whitespace","message","min","max","pattern","color","validator","state","userInfo"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport { Form, Input, Button,message} from 'antd';\r\nimport { connect } from 'react-redux'\r\nimport {createSaveUserInfoAction} from '../../redux/actions_creators/login_action'\r\nimport './css/login.less'\r\nimport {reqLogin} from '../../api'\r\nimport { UserOutlined, LockOutlined } from '@ant-design/icons'\r\nimport logo from './img/dora_17.png'\r\nimport { Redirect } from 'react-router-dom';\r\nconst { Item } = Form\r\n\r\nconst Login = (props) => {\r\n    const [form] = Form.useForm();\r\n    // 如果用户已经登录 自动跳转到管理界面\r\n    /* const user = props.user\r\n    if (user._id) {\r\n      return <Redirect to='/home'/>\r\n    } */\r\n    // 点击登录按钮的回调\r\n    const onFinish = (async(values) => {\r\n      // console.log('Received values of form: ', values);\r\n  \r\n      // 请求登录\r\n      const {username,password} = values\r\n  \r\n      /* reqLogin(username,password).then(response => {\r\n        console.log('成功了',response.data);\r\n      }).catch(error => {\r\n        console.log('失败了',error.message);\r\n      }) */\r\n      \r\n      //#region \r\n      // 优化1\r\n      \r\n        const result = await reqLogin(username,password)\r\n        let {data,status,msg} = result        \r\n        // {status:0, data:user}  {status:1,msg:'xxx'}\r\n        if (status === 0) {  //登录成功\r\n          // 提示登录成功\r\n          // console.log('请求成功了',data);\r\n          message.success('登录成功')\r\n          // 跳转到admin界面（不需要再回退回到登录）\r\n          props.saveUserInfo(data)\r\n          props.history.replace('/Admin')\r\n\r\n        } else {   //登录失败\r\n          message.warning(msg,1)  //提示错误信息\r\n        }\r\n      \r\n    });\r\n     \r\n\r\n    const NameValidator = (value) => {\r\n        if (value) {\r\n          if (value.length >= 4 && value.length <= 30) {\r\n            return Promise.resolve()\r\n          } else {\r\n            return Promise.resolve()/* reject('名称长度为4-30个字符，一个中文字等于2个字符') */\r\n          }\r\n        } else {\r\n          return Promise.resolve()\r\n        }\r\n      };\r\n\r\n    const tailLayout = {\r\n      wrapperCol: { offset: 10, span: 16 },\r\n  };\r\n\r\n  const {isLogin} = props\r\n  if(isLogin){\r\n    return <Redirect to=\"/Admin/Home\"/>\r\n  }\r\n    return (\r\n      <div className=\"login\">\r\n        <header className=\"login-header\">\r\n          <img src={logo} alt=\"logo\"/>\r\n          <h1>后台管理系统{props.test}</h1>\r\n        </header>\r\n        <section className=\"login-content\">\r\n          <h1>用户登陆</h1>\r\n\r\n          <Form form={form} name=\"normal_login\" className=\"login-form\"\r\n            initialValues={{\r\n              remember: true,\r\n              username:'云显靖'\r\n            }}\r\n            onFinish={onFinish}\r\n            // onSubmit={handleSubmit}\r\n          >\r\n            <Item\r\n              name=\"username\"\r\n              // 声明式验证：直接使用别人定义好的验证规则进行验证\r\n              rules={[\r\n                {required: true, whitespace: true, message: '请输入用户名!'},\r\n                {min: 4, message: '用户名最少4位'},\r\n                {max: 12, message: '用户名最多12位'},\r\n                {pattern: /^[a-zA-Z0-9_]+$/, message: '用户名必须是英文 数字或者下划线组成'},\r\n              ]}\r\n            >\r\n              <Input prefix={<UserOutlined className=\"site-form-item-icon\" />} placeholder=\"用户名\" style={{ color: 'rgba(0,0,0,.25)' }} />\r\n            </Item>\r\n            <Item\r\n              name=\"password\"\r\n              rules={[\r\n                {\r\n                  required: true,\r\n                  message: 'Please input your Password!',\r\n                },{validator: NameValidator,}\r\n              ]}\r\n            >\r\n              <Input prefix={<LockOutlined className=\"site-form-item-icon\" />} type=\"password\" placeholder=\"密码\" style={{ color: 'rgba(0,0,0,.25)' }}/>\r\n            </Item>\r\n            <Item {...tailLayout}>\r\n              <Button type=\"primary\" htmlType=\"submit\" className=\"login-form-button\">\r\n                登录\r\n              </Button>\r\n            </Item>\r\n          </Form>\r\n        </section>\r\n      </div>\r\n    );\r\n  };\r\n// 暴露容器\r\nexport default connect(\r\n    state => ({isLogin:state.userInfo.isLogin}),\r\n  {\r\n    saveUserInfo:createSaveUserInfoAction\r\n  }\r\n)(Login)\r\n\r\n"]},"metadata":{},"sourceType":"module"}