{"ast":null,"code":"import\"antd/es/button/style\";import _Button from\"antd/es/button\";import _regeneratorRuntime from\"C:/Users/PC/Desktop/\\u6E90\\u7801/react_Project/react-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/PC/Desktop/\\u6E90\\u7801/react_Project/react-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/Users/PC/Desktop/\\u6E90\\u7801/react_Project/react-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/PC/Desktop/\\u6E90\\u7801/react_Project/react-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/PC/Desktop/\\u6E90\\u7801/react_Project/react-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/PC/Desktop/\\u6E90\\u7801/react_Project/react-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import\"antd/es/modal/style\";import _Modal from\"antd/es/modal\";var _dec,_class,_temp;import React,{Component}from'react';import{ExclamationCircleOutlined,FullscreenOutlined,FullscreenExitOutlined}from'@ant-design/icons';import'./css/header.less';import dayjs from'dayjs';import{connect}from'react-redux';import{withRouter}from'react-router-dom';import{reqWeather}from'../../../api';import{createDeleteUserInfoAction}from'../../../redux/actions_creators/login_action';import screenfull from'screenfull';import menuList from'../../../config/menu_config';import sunny from'./img/太阳.png';import rainy from'./img/下雨.png';import cloud from'./img/多云.png';import snows from'./img/下雪.png';import cloudy from'./img/阴天.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var confirm=_Modal.confirm;//在非路由组件中，要使用路由组件的api\nvar Header=(_dec=connect(function(state){return{userInfo:state.userInfo,title:state.title};},{deleteUser:createDeleteUserInfoAction}),_dec(_class=withRouter(_class=(_temp=/*#__PURE__*/function(_Component){_inherits(Header,_Component);var _super=_createSuper(Header);function Header(){var _this;_classCallCheck(this,Header);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={isFull:true,date:dayjs().format('YYYY年 MM月DD日 HH:mm:ss'),weatherInfo:{},weatherPic:cloud,title:''};_this.fullScreen=function(){screenfull.toggle();};_this.getWeather=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var weather;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return reqWeather();case 2:weather=_context.sent;_this.setState({weatherInfo:weather});case 4:case\"end\":return _context.stop();}}},_callee);}));_this.destroyAll=function(){_Modal.destroyAll();};_this.logout=function(){var deleteUser=_this.props.deleteUser;confirm({icon:/*#__PURE__*/_jsx(ExclamationCircleOutlined,{}),content:/*#__PURE__*/_jsx(_Button,{onClick:_this.destroyAll,children:\"\\u786E\\u5B9A\\u8981\\u9000\\u51FA?\"}),cancelText:'取消',okText:'确认',onOk:function onOk(){deleteUser();},onCancel:function onCancel(){console.log('Cancel');}});};_this.weatherPic=function(){var weatherInfo=_this.state.weatherInfo;if(weatherInfo.weather==='多云'){_this.setState({weatherPic:cloud});}else if(weatherInfo.weather==='阴'){_this.setState({weatherPic:cloudy});}else if(weatherInfo.weather==='晴'){_this.setState({weatherPic:sunny});}else if(weatherInfo.weather==='雨'){_this.setState({weatherPic:rainy});}else if(weatherInfo.weather==='雪'){_this.setState({weatherPic:snows});}};_this.getTitle=function(){var pathname=_this.props.location.pathname;var pathKey=pathname.split('/').reverse()[0];// console.log(pathKey)\nif(pathname.indexOf('Product')!==-1){pathKey='Product';}var title='';menuList.forEach(function(item){if(item.children instanceof Array){var tmp=item.children.find(function(citem){return citem.path===pathKey;});if(tmp)title=tmp.title;}else{if(pathKey===item.path){title=item.title;}}});_this.setState({title:title});};return _this;}_createClass(Header,[{key:\"componentWillUnmount\",value:function componentWillUnmount(){clearInterval(this.timeID);}},{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;//绑定监听\nscreenfull.on('change',function(){var isFull=!_this2.state.isFull;_this2.setState({isFull:isFull});});this.timeID=setInterval(function(){_this2.setState({date:dayjs().format('YYYY年 MM月DD日 HH:mm:ss')});},1000);this.getWeather();//展示当前菜单名称\nthis.getTitle();}//切换全屏按钮的回调\n},{key:\"render\",value:function render(){var _this$state=this.state,isFull=_this$state.isFull,date=_this$state.date,weatherInfo=_this$state.weatherInfo,weatherPic=_this$state.weatherPic;var user=this.props.userInfo.user;return/*#__PURE__*/_jsxs(\"header\",{className:\"header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"header-top\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u6469\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u5C14\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u5E84\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u56ED\"}),/*#__PURE__*/_jsx(\"span\",{children:\",\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u5FEB\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u4E50\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u7AE5\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u5E74\"})]}),/*#__PURE__*/_jsx(_Button,{size:\"small\",onClick:this.fullScreen,children:isFull?/*#__PURE__*/_jsx(FullscreenOutlined,{}):/*#__PURE__*/_jsx(FullscreenExitOutlined,{})}),/*#__PURE__*/_jsxs(\"span\",{className:\"username\",children:[\"\\u6B22\\u8FCE\\u60A8,\",user.username]}),/*#__PURE__*/_jsx(_Button,{className:\"logout\",type:\"link\",onClick:this.logout,children:\"\\u9000\\u51FA\\u767B\\u5F55\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"header-bottom\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"header-bottom-left\",children:this.props.title||this.state.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"header-bottom-right\",children:[date,/*#__PURE__*/_jsx(\"img\",{src:weatherPic,alt:\"\\u5929\\u6C14\"}),weatherInfo.weather,\"\\xA0\\xA0\\xA0\\u6E29\\u5EA6:\",weatherInfo.temperature,\"\\u2103\"]})]})]});}}]);return Header;}(Component),_temp))||_class)||_class);export default Header;","map":{"version":3,"sources":["C:/Users/PC/Desktop/源码/react_Project/react-project/src/containers/Admin/Header/index.jsx"],"names":["React","Component","ExclamationCircleOutlined","FullscreenOutlined","FullscreenExitOutlined","dayjs","connect","withRouter","reqWeather","createDeleteUserInfoAction","screenfull","menuList","sunny","rainy","cloud","snows","cloudy","confirm","Header","state","userInfo","title","deleteUser","isFull","date","format","weatherInfo","weatherPic","fullScreen","toggle","getWeather","weather","setState","destroyAll","logout","props","icon","content","cancelText","okText","onOk","onCancel","console","log","getTitle","pathname","location","pathKey","split","reverse","indexOf","forEach","item","children","Array","tmp","find","citem","path","clearInterval","timeID","on","setInterval","user","username","temperature"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { Modal, Button } from 'antd'\r\nimport { ExclamationCircleOutlined, FullscreenOutlined, FullscreenExitOutlined } from '@ant-design/icons'\r\nimport './css/header.less'\r\nimport dayjs from 'dayjs'\r\nimport { connect } from 'react-redux'\r\nimport { withRouter } from 'react-router-dom'\r\nimport { reqWeather } from '../../../api'\r\nimport { createDeleteUserInfoAction } from '../../../redux/actions_creators/login_action'\r\nimport screenfull from 'screenfull'\r\nimport menuList from '../../../config/menu_config'\r\nimport sunny from './img/太阳.png'\r\nimport rainy from './img/下雨.png'\r\nimport cloud from './img/多云.png'\r\nimport snows from './img/下雪.png'\r\nimport cloudy from './img/阴天.png'\r\nconst { confirm } = Modal;\r\n\r\n//在非路由组件中，要使用路由组件的api\r\n\r\n@connect(\r\n    state => ({\r\n        userInfo: state.userInfo,\r\n        title: state.title\r\n    }),\r\n    {\r\n        deleteUser: createDeleteUserInfoAction,\r\n    }\r\n\r\n)\r\n@withRouter\r\nclass Header extends Component {\r\n    //初始化状态\r\n    state = {\r\n        isFull: true,\r\n        date: dayjs().format('YYYY年 MM月DD日 HH:mm:ss'),\r\n        weatherInfo: {},\r\n        weatherPic: cloud,\r\n        title: ''\r\n    }\r\n    componentWillUnmount() {\r\n        clearInterval(this.timeID)\r\n    }\r\n    componentDidMount() {\r\n        //绑定监听\r\n        screenfull.on('change', () => {\r\n            const isFull = !this.state.isFull\r\n            this.setState({ isFull })\r\n        });\r\n        this.timeID = setInterval(() => {\r\n            this.setState({ date: dayjs().format('YYYY年 MM月DD日 HH:mm:ss') })\r\n        }, 1000)\r\n        this.getWeather()\r\n        //展示当前菜单名称\r\n        this.getTitle()\r\n    }\r\n    //切换全屏按钮的回调\r\n    fullScreen = () => {\r\n        screenfull.toggle()\r\n    }\r\n    //获取天气信息的回调\r\n    getWeather = async () => {\r\n        const weather = await reqWeather()\r\n        this.setState({ weatherInfo: weather })\r\n    }\r\n    //退出登录的回调\r\n    destroyAll = () => {\r\n        Modal.destroyAll();\r\n    }\r\n    logout = () => {\r\n        const { deleteUser } = this.props\r\n        confirm({\r\n            icon: <ExclamationCircleOutlined />,\r\n            content: <Button onClick={this.destroyAll}>确定要退出?</Button>,\r\n            cancelText: '取消',\r\n            okText: '确认',\r\n            onOk: () => {\r\n                deleteUser()\r\n            },\r\n            onCancel() {\r\n                console.log('Cancel');\r\n            },\r\n        });\r\n    }\r\n    //由于接口不提供图片，创建改变天气图片的回调\r\n    weatherPic = () => {\r\n        const { weatherInfo } = this.state\r\n        if (weatherInfo.weather === '多云') {\r\n            this.setState({ weatherPic: cloud })\r\n        }\r\n        else if (weatherInfo.weather === '阴') {\r\n            this.setState({ weatherPic: cloudy })\r\n        }\r\n        else if (weatherInfo.weather === '晴') {\r\n            this.setState({ weatherPic: sunny })\r\n        }\r\n        else if (weatherInfo.weather === '雨') {\r\n            this.setState({ weatherPic: rainy })\r\n        }\r\n        else if (weatherInfo.weather === '雪') {\r\n            this.setState({ weatherPic: snows })\r\n        }\r\n\r\n    }\r\n    getTitle = () => {\r\n        let { pathname } = this.props.location\r\n\r\n        let pathKey = pathname.split('/').reverse()[0]\r\n        // console.log(pathKey)\r\n        if (pathname.indexOf('Product') !== -1) { pathKey = 'Product' }\r\n        let title = ''\r\n        menuList.forEach((item) => {\r\n            if (item.children instanceof Array) {\r\n                const tmp = item.children.find((citem) => {\r\n                    return citem.path === pathKey\r\n                })\r\n                if (tmp) title = tmp.title\r\n            } else {\r\n                if (pathKey === item.path) {\r\n                    title = item.title\r\n                }\r\n            }\r\n        })\r\n        this.setState({ title })\r\n    }\r\n\r\n    render() {\r\n        const { isFull, date, weatherInfo, weatherPic } = this.state\r\n        const { user } = this.props.userInfo\r\n        return (\r\n            <header className='header'>\r\n                <div className=\"header-top\">\r\n                    {/* <p className=\"article\">摩尔庄园,快乐童年</p> */}\r\n                    <div className=\"container\">\r\n                        <span>摩</span>\r\n                        <span>尔</span>\r\n                        <span>庄</span>\r\n                        <span>园</span>\r\n                        <span>,</span>\r\n                        <span>快</span>\r\n                        <span>乐</span>\r\n                        <span>童</span>\r\n                        <span>年</span>\r\n                    </div>\r\n\r\n                    <Button size=\"small\" onClick={this.fullScreen}>\r\n                        {isFull ? <FullscreenOutlined /> : <FullscreenExitOutlined />}\r\n                    </Button>\r\n                    <span className=\"username\">欢迎您,{user.username}</span>\r\n                    <Button className=\"logout\" type=\"link\" onClick={this.logout}>退出登录</Button>\r\n                </div>\r\n                <div className=\"header-bottom\">\r\n                    <div className=\"header-bottom-left\">\r\n                        {this.props.title || this.state.title}\r\n                    </div>\r\n                    <div className=\"header-bottom-right\">\r\n                        {date}\r\n                        <img src={weatherPic} alt=\"天气\" />\r\n                        {weatherInfo.weather}&nbsp;&nbsp;&nbsp;温度:{weatherInfo.temperature}℃\r\n                    </div>\r\n                </div>\r\n            </header>\r\n        )\r\n    }\r\n}\r\nexport default Header\r\n\r\n"]},"metadata":{},"sourceType":"module"}