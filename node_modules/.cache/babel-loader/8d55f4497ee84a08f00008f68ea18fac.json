{"ast":null,"code":"import \"antd/es/modal/style\";\nimport _Modal from \"antd/es/modal\";\nimport \"antd/es/card/style\";\nimport _Card from \"antd/es/card\";\nimport \"antd/es/table/style\";\nimport _Table from \"antd/es/table\";\nimport \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/message/style\";\nimport _message from \"antd/es/message\";\nvar _jsxFileName = \"C:\\\\Users\\\\PC\\\\Desktop\\\\react-project\\\\src\\\\containers\\\\Category\\\\index.jsx\";\nimport React, { Component } from 'react';\nimport { PlusCircleOutlined } from '@ant-design/icons';\nimport { reqCategoryList, reqAddCategorys } from '../../api/index';\nimport { PAGE_SIZE } from '../../config';\nimport AddForm from '../../components/AddForm';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default class Category extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      categoryList: [],\n      //商品分类列表\n      visible: false,\n      //控制弹窗隐藏或显示\n      operType: 'add',\n      //操作类型\n      showStatus: 0,\n      //标识添加/更新的确认框是否显示\n      categorys: [],\n      //一级分类列表 \n      parentId: '0' //当前需要显示的分类列表的父分类ID\n\n    };\n\n    this.getCategoryList = async () => {\n      let result = await reqCategoryList();\n      const {\n        status,\n        data,\n        msg\n      } = result;\n      /* data.map((item)=>{\r\n          item.key = item._id\r\n          return item\r\n      }) */\n\n      if (status === 0) {\n        this.setState({\n          categoryList: data\n        });\n      } else {\n        _message.error(msg, 1);\n      }\n    };\n\n    this.demo = a => {\n      console.log(a);\n    };\n\n    this.showAdd = () => {\n      this.setState({\n        operType: 'add',\n        visible: true\n      });\n    };\n\n    this.showUpdate = () => {\n      this.setState({\n        operType: 'update',\n        visible: true\n      });\n    };\n\n    this.handleCancel = () => {\n      this.setState({\n        visible: false\n      });\n      this.form.resetFields();\n    };\n\n    this.handleOk = () => {\n      // 进行表单验证\n      this.form.validateFields(async (err, values) => {\n        if (!err) {\n          // 隐藏确认框\n          this.setState({\n            showStatus: 0\n          }); // 收集数据并提交添加分类请求\n\n          const {\n            parentId,\n            categoryName\n          } = values; // 清除输入数据\n\n          this.form.resetFields();\n          const result = await reqAddCategorys(categoryName, parentId);\n\n          if (result.status === 0) {\n            // 代表成功\n            // 添加的分类就是当前分类列表下的分类\n            if (parentId === this.state.parentId) {\n              // 重新获取当前分类列表显示\n              this.getCategorys();\n            } else if (parentId === '0') {\n              // 在二级分类列表下添加一级分类 重新获取一级分类列表 但是不需要显示一级列表\n              this.getCategorys('0');\n            }\n          }\n        }\n      });\n    };\n  }\n\n  componentDidMount() {\n    //请求商品分类列表\n    this.getCategoryList();\n  } //获取商品分类列表\n\n\n  render() {\n    const {\n      categoryList,\n      visible,\n      operType\n    } = this.state;\n    const dataSource = categoryList;\n    const columns = [{\n      title: '分类名',\n      dataIndex: 'name',\n      key: 'name'\n    }, {\n      title: '操作',\n      dataIndex: 'name',\n      key: 'haha',\n      render: a => {\n        return /*#__PURE__*/_jsxDEV(_Button, {\n          type: \"link\",\n          onClick: this.showUpdate,\n          children: \"\\u4FEE\\u6539\\u5206\\u7C7B\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 41\n        }, this);\n      },\n      width: '25%',\n      align: 'center'\n    }];\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(_Card, {\n        title: \"\",\n        extra: /*#__PURE__*/_jsxDEV(_Button, {\n          onClick: this.showAdd,\n          type: \"primary\",\n          href: \"#\",\n          children: [/*#__PURE__*/_jsxDEV(PlusCircleOutlined, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 21\n          }, this), \"\\u6DFB\\u52A0\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 39\n        }, this),\n        children: [/*#__PURE__*/_jsxDEV(_Table, {\n          rowKey: \"_id\",\n          bordered: true,\n          dataSource: dataSource,\n          columns: columns,\n          pagination: {\n            pageSize: PAGE_SIZE\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 21\n        }, this), \";\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(_Modal, {\n        okText: \"\\u786E\\u5B9A\",\n        cancelText: \"\\u53D6\\u6D88\",\n        title: operType === 'add' ? '新增分类' : '修改分类',\n        visible: visible,\n        onOk: this.handleOk,\n        onCancel: this.handleCancel,\n        children: /*#__PURE__*/_jsxDEV(AddForm, {\n          categorys: categorys,\n          parentId: parentId,\n          setForm: form => {\n            this.form = form;\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true);\n  }\n\n}","map":{"version":3,"sources":["C:/Users/PC/Desktop/react-project/src/containers/Category/index.jsx"],"names":["React","Component","PlusCircleOutlined","reqCategoryList","reqAddCategorys","PAGE_SIZE","AddForm","Category","state","categoryList","visible","operType","showStatus","categorys","parentId","getCategoryList","result","status","data","msg","setState","error","demo","a","console","log","showAdd","showUpdate","handleCancel","form","resetFields","handleOk","validateFields","err","values","categoryName","getCategorys","componentDidMount","render","dataSource","columns","title","dataIndex","key","width","align","pageSize"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { Card, Button, Table, message, Modal } from 'antd';\r\nimport { PlusCircleOutlined } from '@ant-design/icons'\r\nimport { reqCategoryList,reqAddCategorys } from '../../api/index'\r\nimport { PAGE_SIZE } from '../../config'\r\nimport AddForm from '../../components/AddForm'\r\n\r\nexport default class Category extends Component {\r\n    state = {\r\n        categoryList: [],//商品分类列表\r\n        visible: false,//控制弹窗隐藏或显示\r\n        operType: 'add',//操作类型\r\n        showStatus: 0, //标识添加/更新的确认框是否显示\r\n        categorys: [], //一级分类列表 \r\n        parentId: '0', //当前需要显示的分类列表的父分类ID\r\n    }\r\n    componentDidMount() {\r\n        //请求商品分类列表\r\n        this.getCategoryList()\r\n    }\r\n    //获取商品分类列表\r\n    getCategoryList = async () => {\r\n        let result = await reqCategoryList()\r\n        const { status, data, msg } = result\r\n        /* data.map((item)=>{\r\n            item.key = item._id\r\n            return item\r\n        }) */\r\n        if (status === 0) {\r\n            this.setState({ categoryList: data })\r\n        } else {\r\n            message.error(msg, 1)\r\n        }\r\n    }\r\n    demo = (a) => {\r\n        console.log(a);\r\n    }\r\n\r\n    // 展示弹窗\r\n    showAdd = () => {\r\n        this.setState({\r\n            operType: 'add',\r\n            visible: true,\r\n        })\r\n    }\r\n    showUpdate = () => {\r\n        this.setState({\r\n            operType: 'update',\r\n            visible: true\r\n        })\r\n    }\r\n    // 响应点击取消\r\n    handleCancel = () => {\r\n        this.setState({ visible: false })\r\n        this.form.resetFields()\r\n    }\r\n    // 显示添加的确认框\r\n    handleOk = () => {\r\n         // 进行表单验证\r\n      this.form.validateFields(async (err,values)=>{\r\n        if (!err) {\r\n          // 隐藏确认框\r\n          this.setState({showStatus:0})\r\n          // 收集数据并提交添加分类请求\r\n          const {parentId,categoryName} = values\r\n          // 清除输入数据\r\n          this.form.resetFields()\r\n          const result = await reqAddCategorys(categoryName,parentId)\r\n          if (result.status === 0) {\r\n            // 代表成功\r\n            \r\n            // 添加的分类就是当前分类列表下的分类\r\n            if (parentId === this.state.parentId) {\r\n              // 重新获取当前分类列表显示\r\n              this.getCategorys()\r\n            } else if (parentId==='0') {\r\n              // 在二级分类列表下添加一级分类 重新获取一级分类列表 但是不需要显示一级列表\r\n              this.getCategorys('0')\r\n            }\r\n          }\r\n        }\r\n      }) \r\n    };\r\n\r\n\r\n    render() {\r\n        const { categoryList, visible, operType } = this.state\r\n        const dataSource = categoryList\r\n        const columns = [\r\n            {\r\n                title: '分类名',\r\n                dataIndex: 'name',\r\n                key: 'name',\r\n            },\r\n            {\r\n                title: '操作',\r\n                dataIndex: 'name',\r\n                key: 'haha',\r\n                render: (a) => { return <Button type=\"link\" onClick={this.showUpdate}>修改分类</Button> },\r\n                width: '25%',\r\n                align: 'center'\r\n            },\r\n        ];\r\n        return (\r\n            <>\r\n                <Card title=\"\" extra={<Button onClick={this.showAdd} type=\"primary\" href=\"#\">\r\n                    <PlusCircleOutlined />添加</Button>}>\r\n                    <Table rowKey=\"_id\" bordered={true} dataSource={dataSource} columns={columns} pagination={{ pageSize: PAGE_SIZE }} />;\r\n                </Card>\r\n                <Modal okText=\"确定\" cancelText=\"取消\" title={operType === 'add' ? '新增分类' : '修改分类'} visible={visible} onOk={this.handleOk} onCancel={this.handleCancel}>\r\n                    <AddForm categorys={categorys} parentId={parentId}\r\n                        setForm={(form) => { this.form = form }} />\r\n                </Modal>\r\n            </>\r\n        )\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}