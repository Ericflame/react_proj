{"ast":null,"code":"import \"antd/es/modal/style\";\nimport _Modal from \"antd/es/modal\";\nimport \"antd/es/upload/style\";\nimport _Upload from \"antd/es/upload\";\nimport \"antd/es/message/style\";\nimport _message from \"antd/es/message\";\nvar _jsxFileName = \"C:\\\\Users\\\\PC\\\\Desktop\\\\react-project\\\\src\\\\containers\\\\Product\\\\picture_wall.jsx\";\nimport React, { Component } from 'react';\nimport { PlusOutlined } from '@ant-design/icons';\nimport { reqDeletePicture } from '../../api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction getBase64(file) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n\n    reader.onload = () => resolve(reader.result);\n\n    reader.onerror = error => reject(error);\n  });\n}\n\nclass PicturesWall extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      previewVisible: false,\n      //是否展示预览窗\n      //要预览的图片的url地址\n      previewImage: 'https://img2.huashi6.com/images/resource/2017/02/07/613h20011p0.jpg?imageView2/3/q/100/interlace/1/w/448/h/1600/format/webp',\n      previewTitle: '',\n      fileList: [//收集好的所有上传完毕的图片名\n\n        /* {\r\n          uid: '-1',\r\n          name: 'image.png',\r\n          status: 'done',//当前图片的状态：uploading\\done\\remove\r\n          url: 'https://img2.huashi6.com/images/resource/2019/01/02/72h455834p0.png?imageView2/3/q/100/interlace/1/w/448/h/1600/format/webp',\r\n        }, */\n\n        /*       {\r\n                uid: '-2',\r\n                name: 'image.png',\r\n                status: 'done',\r\n                url: 'https://img2.huashi6.com/images/resource/2021/05/12/h89778896p0.jpg?imageView2/3/q/100/interlace/1/w/448/h/1600/format/webp',\r\n              },\r\n              {\r\n                uid: '-3',\r\n                name: 'image.png',\r\n                status: 'done',\r\n                url: 'https://img2.huashi6.com/images/resource/2018/09/09/7h0612393p0.png?imageView2/3/q/100/interlace/1/w/448/h/1600/format/webp',\r\n              },\r\n              {\r\n                uid: '-4',\r\n                name: 'image.png',\r\n                status: 'done',\r\n                url: 'https://img2.huashi6.com/images/resource/2018/09/16/70h719730p0.png?imageView2/3/q/100/interlace/1/w/448/h/1600/format/webp',\r\n              },\r\n              {\r\n                uid: '-xxx',\r\n                percent: 50,\r\n                name: 'image.png',\r\n                status: 'uploading',\r\n                url: 'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png',\r\n              },\r\n              {\r\n                uid: '-5',\r\n                name: 'image.png',\r\n                status: 'error',\r\n              }, */\n      ]\n    };\n\n    this.handleCancel = () => this.setState({\n      previewVisible: false\n    });\n\n    this.handlePreview = async file => {\n      //如果图片没有url也没有转换过base64，那么调用如下方法把图片转换为base64\n      if (!file.url && !file.preview) {\n        file.preview = await getBase64(file.originFileObj);\n      }\n\n      this.setState({\n        previewImage: file.url || file.preview,\n        previewVisible: true,\n        previewTitle: file.name || file.url.substring(file.url.lastIndexOf('/') + 1)\n      });\n    };\n\n    this.handleChange = async ({\n      file,\n      fileList\n    }) => {\n      if (file.status === 'done') {\n        //若上传成功\n\n        /* console.log(file.response.data.url);\r\n        console.log(file);\r\n        console.log(fileList);\r\n        console.log(fileList.length); */\n        // file.url = file.response.data.url\n        fileList[fileList.length - 1].url = file.response.data.url;\n        fileList[fileList.length - 1].name = file.response.data.name;\n      }\n\n      if (file.status === 'removed') {\n        //删除了某个文件\n        // console.log(file.name);\n        let result = await reqDeletePicture(file.name);\n        const {\n          status,\n          msg\n        } = result;\n\n        if (status === 0) {\n          _message.success('删除图片成功');\n        } else {\n          _message.error('删除图片失败');\n        }\n      }\n\n      this.setState({\n        fileList\n      });\n    };\n  }\n\n  // resoponse.data.url\n  // thumbUrl\n  render() {\n    const {\n      previewVisible,\n      previewImage,\n      fileList,\n      previewTitle\n    } = this.state;\n\n    const uploadButton = /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(PlusOutlined, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: 8\n        },\n        children: \"Upload\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this);\n\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(_Upload, {\n        //接收图片服务器地址\n        action: \"/manage/img/upload\",\n        method: \"post\",\n        name: \"image\",\n        listType: \"picture-card\" //照片墙的展示方式\n        ,\n        fileList: fileList //图片列表，一个数组中包含着多个图片对象{uid:xxx,status:xxx,url:xxx}\n        ,\n        onPreview: this.handlePreview //当点击预览按钮的回调\n        ,\n        onChange: this.handleChange //图片状态改变的回调(图片上传中，图片被删除，图片成功上传)\n        ,\n        children: fileList.length >= 8 ? null : uploadButton\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(_Modal, {\n        visible: previewVisible,\n        title: previewTitle,\n        footer: null,\n        onCancel: this.handleCancel,\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          alt: \"example\",\n          style: {\n            width: '100%'\n          },\n          src: previewImage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n}\n\nexport default PicturesWall;","map":{"version":3,"sources":["C:/Users/PC/Desktop/react-project/src/containers/Product/picture_wall.jsx"],"names":["React","Component","PlusOutlined","reqDeletePicture","getBase64","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","error","PicturesWall","state","previewVisible","previewImage","previewTitle","fileList","handleCancel","setState","handlePreview","url","preview","originFileObj","name","substring","lastIndexOf","handleChange","status","length","response","data","msg","success","render","uploadButton","marginTop","width"],"mappings":"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","sourcesContent":["import { Upload, Modal, message } from 'antd';\r\nimport React, { Component } from 'react'\r\nimport { PlusOutlined } from '@ant-design/icons';\r\nimport { reqDeletePicture } from '../../api'\r\n\r\nfunction getBase64(file) {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = () => resolve(reader.result);\r\n    reader.onerror = error => reject(error);\r\n  });\r\n}\r\n\r\nclass PicturesWall extends Component {\r\n  state = {\r\n    previewVisible: false,//是否展示预览窗\r\n    //要预览的图片的url地址\r\n    previewImage: 'https://img2.huashi6.com/images/resource/2017/02/07/613h20011p0.jpg?imageView2/3/q/100/interlace/1/w/448/h/1600/format/webp',\r\n    previewTitle: '',\r\n    fileList: [//收集好的所有上传完毕的图片名\r\n      /* {\r\n        uid: '-1',\r\n        name: 'image.png',\r\n        status: 'done',//当前图片的状态：uploading\\done\\remove\r\n        url: 'https://img2.huashi6.com/images/resource/2019/01/02/72h455834p0.png?imageView2/3/q/100/interlace/1/w/448/h/1600/format/webp',\r\n      }, */\r\n      /*       {\r\n              uid: '-2',\r\n              name: 'image.png',\r\n              status: 'done',\r\n              url: 'https://img2.huashi6.com/images/resource/2021/05/12/h89778896p0.jpg?imageView2/3/q/100/interlace/1/w/448/h/1600/format/webp',\r\n            },\r\n            {\r\n              uid: '-3',\r\n              name: 'image.png',\r\n              status: 'done',\r\n              url: 'https://img2.huashi6.com/images/resource/2018/09/09/7h0612393p0.png?imageView2/3/q/100/interlace/1/w/448/h/1600/format/webp',\r\n            },\r\n            {\r\n              uid: '-4',\r\n              name: 'image.png',\r\n              status: 'done',\r\n              url: 'https://img2.huashi6.com/images/resource/2018/09/16/70h719730p0.png?imageView2/3/q/100/interlace/1/w/448/h/1600/format/webp',\r\n            },\r\n            {\r\n              uid: '-xxx',\r\n              percent: 50,\r\n              name: 'image.png',\r\n              status: 'uploading',\r\n              url: 'https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png',\r\n            },\r\n            {\r\n              uid: '-5',\r\n              name: 'image.png',\r\n              status: 'error',\r\n            }, */\r\n    ],\r\n  };\r\n  //关闭预览窗\r\n  handleCancel = () => this.setState({ previewVisible: false });\r\n  //展示预览窗\r\n  handlePreview = async file => {\r\n    //如果图片没有url也没有转换过base64，那么调用如下方法把图片转换为base64\r\n    if (!file.url && !file.preview) {\r\n      file.preview = await getBase64(file.originFileObj);\r\n    }\r\n\r\n    this.setState({\r\n      previewImage: file.url || file.preview,\r\n      previewVisible: true,\r\n      previewTitle: file.name || file.url.substring(file.url.lastIndexOf('/') + 1),\r\n    });\r\n  };\r\n\r\n  //当图片状态发生改变的回调\r\n  handleChange = async ({ file, fileList }) => {\r\n    if (file.status === 'done') {\r\n      //若上传成功\r\n      /* console.log(file.response.data.url);\r\n      console.log(file);\r\n      console.log(fileList);\r\n      console.log(fileList.length); */\r\n      // file.url = file.response.data.url\r\n      fileList[fileList.length - 1].url = file.response.data.url\r\n      fileList[fileList.length - 1].name = file.response.data.name\r\n    }\r\n    if (file.status === 'removed') {\r\n      //删除了某个文件\r\n      // console.log(file.name);\r\n      let result = await reqDeletePicture(file.name)\r\n      const { status, msg } = result\r\n      if (status === 0) {\r\n        message.success('删除图片成功')\r\n      } else {\r\n        message.error('删除图片失败')\r\n      }\r\n    }\r\n    this.setState({ fileList })\r\n  };\r\n  \r\n\r\n\r\n\r\n  // resoponse.data.url\r\n  // thumbUrl\r\n  render() {\r\n    const { previewVisible, previewImage, fileList, previewTitle } = this.state;\r\n    const uploadButton = (\r\n      <div>\r\n        <PlusOutlined />\r\n        <div style={{ marginTop: 8 }}>Upload</div>\r\n      </div>\r\n    );\r\n    return (\r\n      <>\r\n        <Upload\r\n          //接收图片服务器地址\r\n          action=\"/manage/img/upload\"\r\n          method=\"post\"\r\n          name='image'\r\n          listType=\"picture-card\"//照片墙的展示方式\r\n          fileList={fileList}//图片列表，一个数组中包含着多个图片对象{uid:xxx,status:xxx,url:xxx}\r\n          onPreview={this.handlePreview}//当点击预览按钮的回调\r\n          onChange={this.handleChange}//图片状态改变的回调(图片上传中，图片被删除，图片成功上传)\r\n        >\r\n          {fileList.length >= 8 ? null : uploadButton}\r\n        </Upload>\r\n        <Modal\r\n          visible={previewVisible}\r\n          title={previewTitle}\r\n          footer={null}\r\n          onCancel={this.handleCancel}\r\n        >\r\n          <img alt=\"example\" style={{ width: '100%' }} src={previewImage} />\r\n        </Modal>\r\n      </>\r\n    );\r\n  }\r\n}\r\nexport default PicturesWall"]},"metadata":{},"sourceType":"module"}